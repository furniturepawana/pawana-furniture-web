<!-- Room Hero Section -->
<section class="room-hero">
  <div class="room-hero-content">
    <h1><%= room.name %></h1>
    <% if (room.description) { %>
    <p><%= room.description %></p>
    <% } else { %>
    <p>Explore our curated collections for your <%= room.name.toLowerCase() %></p>
    <% } %>
  </div>
</section>

<section class="breadcrumb-section">
  <div class="breadcrumb-container">
    <div class="page-breadcrumb">
      <a href="javascript:history.back()" class="breadcrumb-back" aria-label="Go back">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 12h18M3 12l6-6M3 12l6 6"/>
        </svg>
      </a>
      <a href="/">Home</a> /
      <span><%= room.name %></span>
    </div>
  </div>
</section>

<!-- Sets in This Room -->
<% if (sets && sets.length > 0) { %>
<%
  // Extract unique styles for the filter dropdown
  // Custom order: Royal -> Traditional -> Modern
  const styleOrder = ['Royal', 'Traditional', 'Modern'];
  const styles = [...new Set(sets.map(set => set.style))].sort((a, b) => {
    const aIndex = styleOrder.indexOf(a);
    const bIndex = styleOrder.indexOf(b);
    if (aIndex === -1 && bIndex === -1) return a.localeCompare(b);
    if (aIndex === -1) return 1;
    if (bIndex === -1) return -1;
    return aIndex - bIndex;
  });
%>
<section class="room-sets-section">
  <div class="room-sets-container">
    <!-- Sets List -->
    <div class="room-type-header">
      <div class="room-type-header-left">
        <h2>Complete <%= room.name %> Sets</h2>
      </div>

      <div class="room-type-filters">
        <div class="style-filter-tabs" id="style-tabs">
          <button class="style-tab active" data-style="" onclick="filterSets('')">All</button>
          <% styles.forEach(style => { %>
            <button class="style-tab" data-style="<%= style %>" onclick="filterSets('<%= style %>')"><%= style %></button>
          <% }); %>
        </div>
      </div>
    </div>

    <div class="sets-grid">
      <% sets.forEach(set => { %>
        <div class="set-card-wrapper" data-style="<%= set.style %>">
          <a href="/set/<%= set.slug %>" class="set-card">
            <div class="set-card-badge">Set</div>
            <img
              src="<%= set.images && set.images.length > 0 ? set.images[0].url : '/images/placeholder.jpg' %>"
              alt="<%= set.name %>"
            />
            <div class="card-name-row">
              <h3><%= set.name %></h3>
              <button class="wishlist-btn"
                      data-id="<%= set._id %>"
                      data-type="set"
                      data-name="<%= set.name %>"
                      data-slug="<%= set.slug %>"
                      data-image="<%= set.images && set.images.length > 0 ? set.images[0].url : '/images/placeholder.jpg' %>"
                      onclick="event.preventDefault(); handleWishlistClick(event, this)">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
                </svg>
              </button>
            </div>
            <div class="set-card-meta">
              <span class="set-style-badge <%= set.style.toLowerCase() %>"><%= set.style %></span>
              <p><%= set.room %> Â· <%= set.code %></p>
            </div>
          </a>
        </div>
      <% }); %>
    </div>

    <!-- Pagination -->
    <div class="pagination-container" id="room-pagination"></div>
  </div>
</section>

<script>
  let roomPagination = null;

  function filterSets(selectedStyle) {
    const sets = document.querySelectorAll('.set-card-wrapper');
    const setsGrid = document.querySelector('.sets-grid');

    // Update active tab
    const tabs = document.querySelectorAll('.style-tab');
    tabs.forEach(tab => {
      if (tab.getAttribute('data-style') === selectedStyle) {
        tab.classList.add('active');
      } else {
        tab.classList.remove('active');
      }
    });

    let visibleCount = 0;

    sets.forEach(set => {
      const setStyle = set.getAttribute('data-style');
      if (selectedStyle === '' || setStyle === selectedStyle) {
        set.removeAttribute('data-filtered-out');
        visibleCount++;
      } else {
        set.setAttribute('data-filtered-out', 'true');
      }
    });

    // Refresh pagination after filtering
    if (roomPagination) {
      roomPagination.refresh();
    }
  }

  // Initialize pagination on page load
  document.addEventListener('DOMContentLoaded', function() {
    roomPagination = initPagination({
      gridSelector: '.sets-grid',
      itemSelector: '.set-card-wrapper',
      paginationSelector: '#room-pagination',
      desktopPerPage: 15,
      mobilePerPage: 6
    });
  });
</script>
<% } %>

<img src="https://res.cloudinary.com/dwa2d4onb/image/upload/v1763917023/pf_logo_1_xw8ass.png" height="200px">


