<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Only The Finest Furniture</title>

    <!-- Google Fonts: Playfair Display + Lato -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://res.cloudinary.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

    <!-- Preload Hero Image for LCP -->
    <link rel="preload" as="image" href="https://res.cloudinary.com/duiix4ryu/image/upload/w_1920,ar_16:9,c_fill,g_auto,f_auto,q_auto/pawana/hero/pawana_hero" media="(min-width: 1200px)">
    <link rel="preload" as="image" href="https://res.cloudinary.com/duiix4ryu/image/upload/w_1200,ar_16:9,c_fill,g_auto,f_auto,q_auto/pawana/hero/pawana_hero" media="(min-width: 768px) and (max-width: 1199px)">
    <link rel="preload" as="image" href="https://res.cloudinary.com/duiix4ryu/image/upload/w_800,ar_4:5,c_fill,g_center,f_auto,q_auto/pawana/hero/pawana_hero" media="(max-width: 767px)">

    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="/images/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">

    <link rel="manifest" href="/images/site.webmanifest">
    <link rel="shortcut icon" href="/favicon.ico">

    <link rel="stylesheet" href="/css/bundle.css?v=1767524000" />
  </head>

  <body class="<%= typeof pageClass !== 'undefined' ? pageClass : '' %>">
    <!-- Header -->
    <header class="site-header">
      <a class="logo" href="/">
        <img src="https://res.cloudinary.com/dwa2d4onb/image/upload/v1763917320/pf_icon_rxglcl.png" alt="Pawana Furniture Logo" class="logo-image">
        <span class="logo-text">Pawana® <span class="logo-text-light">Furniture</span></span>
      </a>
      <nav class="nav-links">
      <a href="/about">About Pawana</a>
      <div class="dropdown">
        <a href="/catalogue">Collection</a>
        <div class="dropdown-content collections-dropdown">
          <div class="dropdown-list">
            <% if (typeof navRooms !== 'undefined' && navRooms.length > 0) { %>
              <% navRooms.forEach(room => { %>
                <div class="dropdown-item">
                  <a href="/room/<%= room.slug %>">
                    <%= room.name %>
                    <% if (room.types && room.types.length > 0) { %>
                      <span class="arrow">›</span>
                    <% } %>
                  </a>
                  <% if (room.types && room.types.length > 0) { %>
                    <div class="sub-dropdown">
                      <% room.types.forEach(type => { %>
                        <a href="/room/<%= room.slug %>/<%= type.toLowerCase() %>"><%= type %></a>
                      <% }); %>
                      <a href="/room/<%= room.slug %>" style="font-weight: 600; margin-top: 5px; border-top: 1px solid rgba(0,0,0,0.05);">View All <%= room.name %></a>
                    </div>
                  <% } %>
                </div>
              <% }); %>
            <% } else { %>
              <!-- Fallback if navRooms is missing -->
              <div class="dropdown-item">
                <a href="/room/living-room">Living Room <span class="arrow">›</span></a>
                <div class="sub-dropdown">
                  <a href="/room/living-room/sofa">Sofas</a>
                  <a href="/room/living-room/chair">Chairs</a>
                  <a href="/room/living-room/table">Tables</a>
                </div>
              </div>
              <div class="dropdown-item">
                <a href="/room/bedroom">Bedroom <span class="arrow">›</span></a>
                <div class="sub-dropdown">
                  <a href="/room/bedroom/bed">Beds</a>
                  <a href="/room/bedroom/cabinet">Wardrobes</a>
                </div>
              </div>
              <div class="dropdown-item">
                <a href="/room/dining-room">Dining Room <span class="arrow">›</span></a>
                <div class="sub-dropdown">
                  <a href="/room/dining-room/table">Dining Tables</a>
                  <a href="/room/dining-room/chair">Dining Chairs</a>
                </div>
              </div>
            <% } %>
          </div>
        </div>
      </div>
           <a href="/services">Services</a>
           <a href="/contact">Contact</a>
       </nav>
       <div class="header-actions">
         <!-- Inline Search -->
         <div class="search-wrapper">
           <button class="header-icon search-icon" aria-label="Search">
             <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
               <circle cx="11" cy="11" r="8"></circle>
               <path d="m21 21-4.35-4.35"></path>
             </svg>
           </button>
           <div class="search-box">
             <input type="text" placeholder="Search furniture..." class="search-input">
             <button class="search-close" aria-label="Close search">
               <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                 <line x1="18" y1="6" x2="6" y2="18"></line>
                 <line x1="6" y1="6" x2="18" y2="18"></line>
               </svg>
             </button>
           </div>
           <!-- Search Results Dropdown -->
           <div class="search-dropdown">
             <div class="search-results"></div>
           </div>
         </div>
         <!-- Wishlist Icon -->
         <div class="wishlist-wrapper">
           <a href="/wishlist" class="header-icon wishlist-icon" aria-label="Wishlist">
             <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
               <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
             </svg>
             <span class="wishlist-count" style="display: none;">0</span>
           </a>
           <!-- Wishlist Preview Dropdown -->
           <div class="wishlist-preview">
             <div class="wishlist-preview-items">
               <p class="wishlist-empty">Your wishlist is empty</p>
             </div>
             <a href="/wishlist" class="wishlist-preview-link">View All</a>
           </div>
         </div>
          <!-- Mobile Menu Button (hamburger) -->
          <button class="mobile-menu-btn" id="mobileMenuBtn" aria-label="Open menu">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <line x1="3" y1="6" x2="21" y2="6"></line>
              <line x1="3" y1="12" x2="21" y2="12"></line>
              <line x1="3" y1="18" x2="21" y2="18"></line>
            </svg>
          </button>
       </div>
    </header>

    <!-- Mobile Navigation Drawer -->
    <div class="mobile-nav-overlay" id="mobileNavOverlay"></div>
    <nav class="mobile-nav-drawer" id="mobileNavDrawer">
      <div class="mobile-nav-header">
        <span class="mobile-nav-title">Menu</span>
        <button class="mobile-nav-close" id="mobileNavClose" aria-label="Close menu">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
      <ul class="mobile-nav-links">
        <li><a href="/about">About Pawana</a></li>
        <li class="mobile-nav-dropdown">
          <a href="/catalogue" class="mobile-nav-link-text">Collection</a>
          <button class="mobile-nav-arrow-btn" aria-label="Expand Collection">
            <span class="mobile-nav-arrow">›</span>
          </button>
        </li>
        <li><a href="/services">Services</a></li>
        <li><a href="/contact">Contact</a></li>
      </ul>
      <div class="mobile-nav-footer">
        <a href="/wishlist" class="mobile-nav-wishlist">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"/>
          </svg>
          View Wishlist
        </a>
      </div>
    </nav>

    <!-- Mobile Rooms Submenu Panel (positioned at Collection level) -->
    <div class="mobile-rooms-panel" id="mobileRoomsPanel">
      <div class="mobile-panel-header">
        <button class="mobile-panel-back" id="mobileRoomsPanelBack" aria-label="Back">
          <span>‹</span>
        </button>
        <span class="mobile-panel-title">Collection</span>
      </div>
      <div class="mobile-panel-content">
        <% if (typeof navRooms !== 'undefined' && navRooms.length > 0) { %>
          <% navRooms.forEach(room => { %>
            <div class="mobile-nav-room" data-room="<%= room.slug %>">
              <a href="/room/<%= room.slug %>" class="mobile-room-link"><%= room.name %></a>
              <% if (room.types && room.types.length > 0) { %>
                <button class="mobile-nav-arrow-btn" aria-label="Expand <%= room.name %>">
                  <span class="mobile-nav-arrow">›</span>
                </button>
                <div class="mobile-nav-types">
                  <% room.types.forEach(type => { %>
                    <a href="/room/<%= room.slug %>/<%= type.toLowerCase() %>"><%= type %></a>
                  <% }); %>
                  <a href="/room/<%= room.slug %>" class="view-all-link">View All</a>
                </div>
              <% } %>
            </div>
          <% }); %>
        <% } else { %>
          <div class="mobile-nav-room">
            <a href="/room/living-room" class="mobile-room-link">Living Room</a>
          </div>
          <div class="mobile-nav-room">
            <a href="/room/bedroom" class="mobile-room-link">Bedroom</a>
          </div>
          <div class="mobile-nav-room">
            <a href="/room/dining-room" class="mobile-room-link">Dining Room</a>
          </div>
        <% } %>
      </div>
    </div>

    <!-- Search Modal (Mobile Only Overlay) -->
    <div id="searchModal" class="search-modal">
      <div class="search-modal-overlay"></div>
      <div class="search-modal-container">
        <div class="search-modal-header">
          <div class="search-modal-input-wrapper">
            <svg class="search-modal-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="11" cy="11" r="8"></circle>
              <path d="m21 21-4.35-4.35"></path>
            </svg>
            <input type="text" placeholder="Search furniture..." class="search-modal-input">
            <button class="search-modal-close" aria-label="Close search">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          </div>
        </div>
        <div class="search-modal-results">
          <!-- Suggestions or Results will be injected here -->
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <main>
      <%- body %>
    </main>

    <!-- Footer -->
    <footer class="site-footer">
      <div class="section-container">
        <div class="footer-grid">
          <div class="footer-brand">
            <a href="/" class="logo footer-logo">
              <span class="logo-text">Pawana® <span class="logo-text-light">Furniture</span></span>
            </a>
            <p><%= footerSettings.tagline1 %></p>
            <p class="footer-tagline"><%= footerSettings.tagline2 %></p>
          </div>

          <div class="footer-col">
            <h4>Shop</h4>
            <ul>
              <li><a href="/catalogue">All Collections</a></li>
              <li><a href="/catalogue?sort=newest">New Arrivals</a></li>
              <li><a href="/room/living-room">Living Room</a></li>
              <li><a href="/room/bedroom">Bedroom</a></li>
            </ul>
          </div>

          <div class="footer-col">
            <h4>Support</h4>
            <ul>
              <li><a href="/services">Our Services</a></li>
              <li><a href="/about">About Us</a></li>
              <li><a href="/contact">Contact Us</a></li>
              <li><a href="/wishlist">Your Wishlist</a></li>
            </ul>
          </div>

          <div class="footer-col footer-contact">
            <h4>Contact Us</h4>
            <div class="footer-contact-info">
              <div class="contact-subsection contact-location">
                <p>
                  <span class="footer-icon-wrapper">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                      <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
                      <circle cx="12" cy="10" r="3"/>
                    </svg>
                  </span>
                  Pawana Furniture by<br>Pawan Kumar,<br><br>Liberty Chowk, Rajpura<br>Patiala Road, NH 7,<br>Punjab<br>India<br>140401
                </p>
              </div>
              <div class="contact-subsection-group">
                <div class="contact-subsection contact-phone">
                  <p>
                    <span class="footer-icon-wrapper">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
                      </svg>
                    </span>
                    +91 8360550271<br>+91 6239811718
                  </p>
                </div>
                <div class="contact-subsection contact-email">
                  <p>
                    <span class="footer-icon-wrapper">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                        <polyline points="22,6 12,13 2,6"/>
                      </svg>
                    </span>
                    pawanafurniture07@gmail.com
                  </p>
                </div>
              </div>
            </div>
            <div class="footer-social">
              <% if (contactSettings.socialMedia?.facebook) { %>
              <a href="<%= contactSettings.socialMedia.facebook %>" class="footer-social-icon" aria-label="Facebook" target="_blank" rel="noopener noreferrer">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
                </svg>
              </a>
              <% } %>
              <% if (contactSettings.socialMedia?.instagram) { %>
              <a href="<%= contactSettings.socialMedia.instagram %>" class="footer-social-icon" aria-label="Instagram" target="_blank" rel="noopener noreferrer">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                  <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
                  <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
                  <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/>
                </svg>
              </a>
              <% } %>
            </div>
          </div>

          <div class="footer-col">
            <h4>Stay in the loop</h4>
            <!-- Hidden iframe for newsletter submission -->
            <iframe name="newsletterFormTarget" id="newsletterFormTarget" style="display:none;"></iframe>

            <form class="newsletter" id="newsletterForm"
                  action="https://formsubmit.co/<%= contactSettings.formEmail %>"
                  method="POST"
                  target="newsletterFormTarget">
              <input type="hidden" name="_subject" value="New Newsletter Subscription - Pawana Furniture">
              <input type="hidden" name="_captcha" value="false">
              <input type="hidden" name="_template" value="table">
              <input type="email" id="newsletterEmail" name="email" placeholder="Email Address" required>
              <button type="submit" class="btn btn-gold" id="newsletterBtn" style="width: 100%">
                <span class="btn-text">Subscribe</span>
                <span class="btn-loader" style="display: none;">
                  <svg class="spinner" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10" stroke-opacity="0.25"/>
                    <path d="M12 2a10 10 0 0 1 10 10" stroke-linecap="round"/>
                  </svg>
                </span>
              </button>
            </form>
            <div class="newsletter-success" id="newsletterSuccess" style="display: none;">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                <polyline points="22 4 12 14.01 9 11.01"></polyline>
              </svg>
              <p>Thank you for subscribing!</p>
            </div>
          </div>
        </div>
        <div class="copyright">
          <%= footerSettings.copyright %>
        </div>
      </div>
    </footer>

    <script src="/js/index.js?v=1735821600"></script>
    <script src="/js/carousel.js?v=1735821600"></script>
    <script src="/js/marquee.js?v=1735821600"></script>
    <script src="/js/dropdown.js?v=1735821600"></script>
    <script src="/js/wishlist.js?v=1735821600"></script>
    <script src="/js/pagination.js?v=1735821600"></script>
    <script src="/js/search.js?v=1735821600"></script>

    <!-- Scroll Animations -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        // Header Scroll Effect - Hide on scroll down, show on scroll up
        const header = document.querySelector('.site-header');
        let lastScrollY = window.scrollY;
        let scrollUpDistance = 0;
        let isNavHidden = false;
        let ticking = false;

        // Use hysteresis to prevent flickering at threshold boundaries
        const SCROLL_THRESHOLD_ADD = 80;    // Add scrolled class after this
        const SCROLL_THRESHOLD_REMOVE = 40; // Remove scrolled class below this
        const NAV_HIDE_THRESHOLD = 120;     // Hide nav after scrolling down this much
        const NAV_SHOW_THRESHOLD = 100;     // Show nav after scrolling up this much

        if (header) {
          // Set initial state without transition
          const initialScrollY = window.scrollY;
          if (initialScrollY > SCROLL_THRESHOLD_ADD) {
            header.classList.add('scrolled');
          }

          window.addEventListener('scroll', () => {
            if (!ticking) {
              window.requestAnimationFrame(() => {
                const currentScrollY = window.scrollY;
                const scrollDelta = lastScrollY - currentScrollY;

                // Hysteresis for scrolled class - prevents flickering at boundary
                if (currentScrollY > SCROLL_THRESHOLD_ADD && !header.classList.contains('scrolled')) {
                  header.classList.add('scrolled');
                } else if (currentScrollY < SCROLL_THRESHOLD_REMOVE && header.classList.contains('scrolled')) {
                  header.classList.remove('scrolled');
                }

                // Track scroll direction for nav hide/show
                if (scrollDelta > 0) {
                  // Scrolling up
                  scrollUpDistance += scrollDelta;

                  // Show navbar after deliberate upward scrolling
                  if (scrollUpDistance >= NAV_SHOW_THRESHOLD && isNavHidden) {
                    header.classList.remove('nav-hidden');
                    isNavHidden = false;
                  }
                } else if (scrollDelta < 0) {
                  // Scrolling down - reset upward distance
                  scrollUpDistance = 0;

                  // Hide navbar after threshold
                  if (currentScrollY > NAV_HIDE_THRESHOLD && !isNavHidden) {
                    header.classList.add('nav-hidden');
                    isNavHidden = true;
                  }
                }

                lastScrollY = currentScrollY;
                ticking = false;
              });
              ticking = true;
            }
          }, { passive: true });
        }

        // Intersection Observer for fade-in animations
        const observerOptions = {
          root: null,
          rootMargin: '0px',
          threshold: 0.1
        };

        const observer = new IntersectionObserver((entries, observer) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('is-visible');
              observer.unobserve(entry.target); // Only animate once
            }
          });
        }, observerOptions);

        // Observe all fade-in sections
        const fadeElements = document.querySelectorAll('.fade-in-section');
        fadeElements.forEach(el => observer.observe(el));

        // Newsletter form submission handler (iframe-based)
        const newsletterForm = document.getElementById('newsletterForm');
        if (newsletterForm) {
          newsletterForm.addEventListener('submit', function() {
            const submitBtn = document.getElementById('newsletterBtn');
            const btnText = submitBtn.querySelector('.btn-text');
            const btnLoader = submitBtn.querySelector('.btn-loader');
            const successMessage = document.getElementById('newsletterSuccess');
            const iframe = document.getElementById('newsletterFormTarget');

            // Show loading state
            btnText.style.display = 'none';
            btnLoader.style.display = 'inline-flex';
            submitBtn.disabled = true;

            // Listen for iframe load (form submission complete)
            iframe.onload = function() {
              if (submitBtn.disabled) {
                // Hide form, show success
                newsletterForm.style.display = 'none';
                successMessage.style.display = 'flex';

                // Reset after 8 seconds
                setTimeout(() => {
                  successMessage.style.display = 'none';
                  newsletterForm.style.display = 'flex';
                  newsletterForm.reset();
                  btnText.style.display = 'inline';
                  btnLoader.style.display = 'none';
                  submitBtn.disabled = false;
                }, 8000);
              }
            };
          });
        }
      });
    </script>
  </body>
</html>
